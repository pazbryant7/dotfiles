#!/usr/bin/env sh

pane_count=$(tmux list-panes | wc -l)
window_count=$(tmux list-windows | wc -l)

if [ "$pane_count" -gt 1 ]; then
	tmux kill-pane
elif [ "$window_count" -gt 1 ]; then
	tmux kill-window
else
	# Check if more than one session exists
	if [ "$(tmux list-sessions | wc -l)" -gt 1 ]; then
		# Store the name of the current session to be killed
		session_to_kill=$(tmux display-message -p '#S')

		# Switch to the last-visited session
		tmux switch-client -l

		# Kill the original session
		tmux kill-session -t "$session_to_kill"
	else
		# This is the last session, so just kill it
		tmux kill-session
	fi
fi
