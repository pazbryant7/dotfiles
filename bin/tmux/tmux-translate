#!/usr/bin/env sh

# **Requirements**
# tmux multiplexer terminal
# translate shell from `soimort`

safe_print() {
	printf '%s' "$1"
}

tmux_translate() {
	translate_from="$1"
	text_to_translate="$2"

	# `man trans` for more details
	translate_opts="-verbose -no-warn -speak"

	tmux neww sh -c "trans $translate_opts $translate_from '$text_to_translate'; \
    echo
    echo
    echo '⚡⚡⚡⚡⚡'; read -n 1"
}

main() {
	translate_from="$1"

	message=""
	case "$translate_from" in
	"en:es")
		message="Translating from English to Spanish"
		;;
	"es:en")
		message="Translating from Spanish to English"
		;;
	*)
		echo "Error: Invalid direction. Please use 'en:es' or 'es:en'."
		exit 1
		;;
	esac

	printf '%s\n\n' "$message"
	IFS= read -r query

	if [ -z "$query" ]; then
		printf "\nNo text entered. Exiting."
		exit 0
	fi

	tmux_translate "$(safe_print "$translate_from")" "$(safe_print "$query")"

	exit 0
}

main "$@"
